<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Promise ì ìš©ì—°ìŠµ2 - async, await</title>
        <script>

            function í™”ë©´ë¿Œë ¤(ì´ê±°){
                document.getElementById("show").innerHTML += ì´ê±° + "<br>";
            }

            ///////////// ë¡œë“œ êµ¬ì—­ ///////////////////
            window.addEventListener("load", ()=>{
                
                // ì œì´ìŠ¨ ë°ì´í„°ë¥¼ ë¡œë”©í•˜ì—¬ ì½ì€ í›„ ë°ì´í„°ë¥¼ í™œìš©í•˜ë„ë¡ Promiseë¥¼ ì ìš©í•œë‹¤!

                /************************************************************************
                    [ ì œì´ìŠ¨ íŒŒì¼ ë‚´ë¶€ í˜•ì‹ì— ê´€í•˜ì—¬ ]
                1.ì œì´ìŠ¨ íŒŒì¼ì€ ë‚´ë¶€ í˜•ì‹ì´ ê°ì²´ í˜•ì‹ì´ì§€ë§Œ ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì†ì„±ëª…ì„ ë³€ìˆ˜í˜•ìœ¼ë¡œ
                ì“°ëŠ” ê²ƒì²˜ëŸ¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ
                -ë°˜ë“œì‹œ "ìŒë”°ì˜´í‘œ"ë¡œ ê°ì‹¸ì„œ ë¬¸ìí˜•ìœ¼ë¡œ í‘œí˜„í•´ì•¼ë§Œ í•¨ (í™‘ë”°ì˜´í‘œë„ ì•ˆë¨)

                2.ì œì´ìŠ¨ íŒŒì¼ ë‚´ë¶€ì— JS ì£¼ì„ë¬¸ì€ ì“¸ ìˆ˜ ì—†ìŒ
                -vscodeì˜ settings.jsonì—ì„œ ì£¼ì„ë¬¸ì€ vscodeì—ì„œ ë³„ë„ì˜ ì²˜ë¦¬ë¥¼ í•˜ë¯€ë¡œ ì‚¬ìš© ê°€ëŠ¥í•œ ê²ƒì„

                3.ì œì´ìŠ¨ì€ ìµœìƒìœ„ í˜•ì‹ìœ¼ë¡œ ê°ì²´ ë˜ëŠ” ë°°ì—´ë¡œì¨ í•˜ë‚˜ë§Œ ì¡´ì¬í•  ìˆ˜ ìˆìŒ
                -ë£¨íŠ¸ê°€ í•˜ë‚˜ì—¬ì•¼ í•œë‹¤ëŠ” ë§ì„
                ex) {ì†ì„±ëª…: ê°’, ì†ì„±ëª…: ê°’, ...} / [{ì†ì„±ëª…: ê°’, ...}, {ì†ì„±ëª…: ê°’, ...}, ...]

                4.ì œì´ìŠ¨ ë§¨ ë§ˆì§€ë§‰ í•­ëª© ë’¤ì— ì½¤ë§ˆë¥¼ ë‚¨ê¸¸ ìˆ˜ ì—†ìŒ (ë‚¨ê¸°ë©´ ì—ëŸ¬ë‚¨)
                -jsì—ì„œëŠ” ë§¨ ë§ˆì§€ë§‰ í•­ëª© ë’¤ì— ì½¤ë§ˆë¥¼ ë‚¨ê²¨ë„ í—ˆìš©í•´ì£¼ê¸° ë•Œë¬¸ì— ì‹¤ìˆ˜ í•  ìˆ˜ ìˆìŒ

                ************************************************************************/


                // ì–´ì”½í¬/ ì–´ì›¨ì´íŠ¸ë¥¼ ìœ„í•œ ì–´ì”½í¬ í•¨ìˆ˜ ë§Œë“¤ê¸°
                async function myAFn(){
                    


                    
                    // 1.ë³€ìˆ˜ = new Promise((ì„±ê³µí•¨ìˆ˜)=>{ì½”ë“œ})
                    // í”„ë¼ë¯¸ìŠ¤ì½”ë“œì— XMLHttpRequestê°ì²´ë¡œ ì œì´ìŠ¨ ë¡œë”©í•˜ê¸°
                    const myProm = new Promise((prFn)=>{ // prFn : ì„±ê³µí•¨ìˆ˜ë¥¼ ë§í•¨
                        // (1)XMLHttpRequset() ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±í•˜ê¸°
                        let ajax = new XMLHttpRequest();

                        // (2)ë¹„ë™ê¸° íŒŒì¼ ìš”ì²­í•˜ê¸°(jsoníŒŒì¼)
                        ajax.open("GET", "./defaultSettings.json");
                        // ->> â­ì œì´ìŠ¨ íŒŒì¼ì€ ì‘ë‹µí˜•ì‹(responseType)ì„ "json"ìœ¼ë¡œ ì„¤ì •í•˜ëŠ” ê²Œ í•„ìˆ˜ì„!!!!!â­
                        ajax.responseType = "json";

                        // ~~ì°¸ê³ ~~
                        // ajax.responseType = "text";
                        // ë§Œì•½ responseType ì„¤ì •ì„ í•˜ì§€ ì•Šìœ¼ë©´ "text"ê°€ ê¸°ë³¸ê°’ì„
                        // ì´ ê²½ìš°ì—” ì œì´ìŠ¨ íŒŒì¼í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆì–´ë„ ì½ì–´ì˜¬ ìˆ˜ ìˆìŒ

                        // (3)ê²°ê³¼ ë¦¬í„´ onload ì´ë²¤íŠ¸ í•¨ìˆ˜ êµ¬ì—­ ë§Œë“¤ê¸°
                        ajax.onload = function(){

                            console.log(ajax.status);

                            if(ajax.status === 200){

                                // í”„ë¼ë¯¸ìŠ¤ ì„±ê³µí•¨ìˆ˜ë¥¼ í†µí•˜ì—¬ ì œì´ìŠ¨ ë°ì´í„° ì „ë‹¬í•˜ê¸°
                                // : ì œì´ìŠ¨ ì•ˆì— ìˆëŠ” ë‚´ìš©ì„ ì „ë‹¬í•˜ëŠ” ê²ƒì„
                                prFn(ajax.response);
                                // responseTypeì„ "json"ìœ¼ë¡œ ì„¤ì •í–ˆìœ¼ë¯€ë¡œ! ê²°ê³¼ê°’ì´ ì œì´ìŠ¨ìœ¼ë¡œ ì „ë‹¬ë¨

                            } ///////////// if : ìƒíƒœê°’ì´ 200(ì„±ê³µ)ì¸ ê²½ìš° /////////////////
                            else{

                                console.log(ajax.statusText);
                                // statusText : ìƒíƒœê°’ì´ í…ìŠ¤íŠ¸í˜•ìœ¼ë¡œ ì°ìŒ
                                // ->> ê²°ê³¼ê°’ì´ nullì´ë©´ ì œì´ìŠ¨ íŒŒì¼ ë‚´ë¶€ í˜•ì‹ì´ ì˜ëª»ëœ ê²½ìš°ì„
                                // ->> ì´ ê²½ìš° ì œì´ìŠ¨ íŒŒì¼ë¡œ ì·¨ê¸‰ë°›ì§€ ëª»í•´ì„œ ì•„ë¬´ê²ƒë„ ë¡œë”© ëª»í•œ ê²°ê³¼ê°€ ë‚˜ì˜¤ëŠ” ê²ƒì„

                            } ///////////// else : ì‹¤íŒ¨ì¸ ê²½ìš° ///////////////////

                        }; //////////////////// onload í•¨ìˆ˜ êµ¬ì—­ //////////////////////

                        // (4)ë¹„ë™ê¸° ìš”ì²­ ë³´ë‚´ê¸° : send()
                        ajax.send();


                    }); /////////// myProm í”„ë¼ë¯¸ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ////////////////


                    // html ì½”ë“œ ìƒì„± í•¨ìˆ˜ (ë§Œë“¤ì–´ë‚¼ ê²ƒë„ asyncí•¨ìˆ˜ ì•ˆì—ë‹¤ê°€ ë§Œë“œë‚˜ë´...!!)
                    const makeHtml = obj => { // obj : ì œì´ìŠ¨ ê°ì²´ë¥¼ ë§í•¨
                        let hcode = `
                        <h1>ìš°ë¦¬ì§‘ ë©ë­‰ì´ ì •ë³´:</h1>
                        <ol>
                            <li>ì´ë¦„ : ${obj[0].ë©ë­‰ì´ì´ë¦„}</li>
                            <li>ì‚¬ëŠ”ê³³ : ${obj[0]["ë©ë­‰ì´ì‚¬ëŠ”ê³³"]}</li>
                            <li>íƒœìƒì§€ : ${obj[0]["ë©ë­‰ì´ì¶œì‹ ì§€ì—­"]}</li>
                            <li>ì¢‹ì•„í•˜ëŠ” ìŒì‹ : ${obj[0]["ë©ë­‰ì´ê°„ì‹"]}</li>
                        </ol>
                        <h1>ìš°ë¦¬ì§‘ ì•¼ì˜¹ì´ ì •ë³´:</h1>
                        <ol>
                            <li>ì´ë¦„ : ${obj[1].ì•¼ì˜¹ì´ì´ë¦„}</li>
                            <li>ì‚¬ëŠ”ê³³ : ${obj[1]["ì•¼ì˜¹ì´ì‚¬ëŠ”ê³³"]}</li>
                            <li>íƒœìƒì§€ : ${obj[1]["ì•¼ì˜¹ì´ì¶œì‹ ì§€ì—­"]}</li>
                            <li>ì¢‹ì•„í•˜ëŠ” ìŒì‹ : ${obj[1]["ì•¼ì˜¹ì´ê°„ì‹"]}</li>
                        </ol>
                        `;

                        return hcode;
                    } ////////////////// makeHtml í•¨ìˆ˜ /////////////////////////////


                    // ğŸ”¥ğŸ”¥ë¨¼ì € ë³€ìˆ˜ì— awaitë¥¼ ì‚¬ìš© í”„ë¼ë¯¸ìŠ¤ ë¦¬í„´ê°’ í• ë‹¹í•˜ê¸°ğŸ”¥ğŸ”¥
                    let temp = await myProm;

                    // í™”ë©´ ì¶œë ¥í•˜ê¸°
                    í™”ë©´ë¿Œë ¤(makeHtml(temp));

                    /*****************************************************************
                        [ ğŸ”¥ğŸ”¥await ì‚¬ìš©ì‹œ ì£¼ì˜ì‚¬í•­ğŸ”¥ğŸ”¥ ]
                    -awaitì—ì„œ í”„ë¼ë¯¸ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë³€ìˆ˜ì— ë‹´ì§€ ì•Šê³  ì‚¬ìš©í•˜ë©´ Pendingì²˜ë¦¬(ë³´ë¥˜ì²˜ë¦¬)ëœ
                    ì¸ìŠ¤í„´ìŠ¤ê°€ ì „ë‹¬ë˜ëŠ” ê²½ìš°ê°€ ìƒê¹€
                    
                    -ë”°ë¼ì„œ ë³€ìˆ˜ì— await í”„ë¼ë¯¸ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë‹´ì•„ì„œ ê·¸ ë¦¬í„´ê°’ì„ í™•ì •í•œ í›„
                    (ë³€ìˆ˜ í• ë‹¹ = ê°’ì„ íŠ¹ì • ì£¼ì†Œì§€ì— ë„£ê³  ì‚¬ìš©í•  ì¤€ë¹„ë¥¼ í•˜ëŠ” ê²ƒ)
                    ê·¸ ê°’ìœ¼ë¡œ í•¨ìˆ˜ë¥¼ ë‹¤ì‹œ í˜¸ì¶œí•˜ë˜ì§€ í›„ì† ì½”ë“œ ì‘ì—…ì„ í•˜ë©´ ë¨
                    ->awaitë¥¼ ë‹´ì€ ë³€ìˆ˜ì— ê°’ì´ í• ë‹¹ë˜ê¸°ì „ì—” ê·¸ ê°’ì„ ì´ìš©í•˜ëŠ” ì½”ë“œë„ ëª¨ë‘ ëŒ€ê¸°ìƒíƒœì„

                    

                    *****************************************************************/


                } /////////////////// myAFn ì–´ì”½í¬ í•¨ìˆ˜ /////////////////////

                // í•„ìˆ˜!! ìµœì´ˆí˜¸ì¶œ ì–´ì”½í¬ í•¨ìˆ˜!1
                myAFn();









            }); ///////////////// ë¡œë“œ êµ¬ì—­ ////////////////////////






            
        </script>
        <style>
            @import url("https://fonts.googleapis.com/css2?family=Gamja+Flower&display=swap");
            body {
                background-image: linear-gradient(to bottom, #494949, gray);
                background-repeat: no-repeat;
                background-attachment: fixed;
                text-align: center;
            }
            #show {
                font-family: "Gamja Flower", cursive;
                font-size: 4vw;
                background-image: linear-gradient(to bottom, lightgreen, pink, orangered, aquamarine);
                background-clip: text;
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-repeat: no-repeat;
                font-weight: bold;
            }
            #doc{
                width: 50%;
                height: 50vh;
                margin: 0 auto;
            }
        </style>
    </head>
    <body>
        <div id="show"></div>
        <div id="doc"></div>
    </body>
</html>
