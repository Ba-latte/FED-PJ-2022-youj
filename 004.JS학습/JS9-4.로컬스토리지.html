<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>JS9-4.ë¡œì»¬ ìŠ¤í† ë¦¬ì§€</title>
        <style>
            html,
            body {
                margin: 0;
                padding: 0;
            }
            .tit {
                max-width: 1000px;
                height: 25vh;
                margin: 0 auto;
                background: url(https://www.crowdnet.or.kr/files/recu/06/20220720153040030_06_47087_20220725_1869.PNG)
                    center 25%/50%;
            }
            .wrap {
                max-width: 1000px;
                min-height: 100vh;
                display: flex;
                margin: 0 auto;
            }
            .wrap > div {
                flex: 1;
                box-sizing: border-box;
                border: 4px double darkblue;
                text-align: center;
            }
            .imgbx {
                max-width: 235px;
                aspect-ratio: 235/381;
                margin: 0 auto;
            }
            .imgbx img {
                object-fit: cover;
                width: 100%;
                height: 100%;
                object-position: left;
            }
            .imgbx.ib2 img {
                object-position: right;
            }

            table {
                width: 90%;
                margin: 20px auto;
                border-collapse: collapse;
            }
            table th {
                border-top: 1px solid #000;
                border-bottom: 1px solid #000;
                padding: 7px 0;
            }
            table td {
                padding: 5px;
            }

            table tr:nth-child(odd) td {
                background-color: #ccc;
            }
        </style>
        <script>
            /* 
            [ JS ë¡œì»¬ìŠ¤í† ë¦¬ì§€ : localStorage ]
            - windowí•˜ìœ„ê°ì²´ window.localStorage
            -> windowëŠ” ì£¼ë¡œ ìƒëµí•¨!

            1. ì •ì˜ : 
                ë¸Œë¼ìš°ì €ë³„ ë¡œì»¬ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì˜ì—­ì— ì €ì¥ë˜ëŠ” 
                ìŠ¤íŠ¸ë§ë°ì´í„° ì €ì¥ì†Œ(JS API)
            2. ìœ ì§€ : ê°™ì€ PC, ê°™ì€ ë¸Œë¼ìš°ì €(ì¬ì„¤ì¹˜ì—†ì´ì‚¬ìš©) ì¼ ê²½ìš° ê³„ì†ìœ ì§€ë¨
                (ë‹¨, ê°™ì€íŒŒì¼ì¼ ì§€ë¼ë„ ì—¬ëŠ” ê²½ë¡œì— ë”°ë¼ ê°™ì€ ë³€ìˆ˜ë„
                ë”°ë¡œ ê´€ë¦¬ëœë‹¤! - ê¸°ì¤€ì´ ë„ë©”ì¸ê²½ë¡œ/ì£¼ì†Œ)
            3. íŠ¹ì§• : ëª¨ë“œ ë°ì´í„°ëŠ” í‚¤,ê°’ ìŒìœ¼ë¡œ êµ¬ì„±ë˜ë©° 
                ë°ì´í„°ê°’ì€ ë°˜ë“œì‹œ ë¬¸ìí˜•ìœ¼ë¡œ ì‚¬ìš©ë¨
            4. ì‘ìš© : ë°ì´í„°ë¡œ ë°°ì—´/ê°ì²´ë¥¼ ì‚¬ìš©í•  ê²½ìš° ë¬¸ìí˜• ë³€í™˜í•˜ì—¬ ë„£ê³ 
                        ë‹¤ì‹œ ê°ì²´í˜•ìœ¼ë¡œ íŒŒì‹±í•˜ì—¬ ì‚¬ìš©í•œë‹¤!
                    (1) ì…ë ¥ì‹œ : JSON.stringify(ë°°ì—´/ê°ì²´)
                    (2) ì‚¬ìš©ì‹œ : JSON.parse(ë¬¸ìí˜•ë°°ì—´/ê°ì²´)
                    -> JSì˜ ì œì´ìŠ¨ ë°ì´í„° íŒŒì‹± ë©”ì„œë“œ : 
                        JSON.parse()
                    -> JSì˜ ì œì´ìŠ¨ í˜•ì‹ ë°ì´í„°ë¥¼ ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ëŠ” ë©”ì„œë“œ:   
                        JSON.stringify()
            5. ì‚¬ìš©ë©”ì„œë“œ : 
                (1) ê°’ì„¤ì • : setItem(í‚¤ëª…,ê°’)
                (2) ê°’ì½ê¸° : getItem(í‚¤ëª…)
                (3) ì „ì²´ì§€ìš°ê¸° : clear()
                (4) í‚¤ë²ˆí˜¸ì½ê¸° : key(ìˆœë²ˆ) -> 0ë¶€í„° (í‚¤ì´ë¦„ë¦¬í„´)
                (5) ê°œë³„í•­ëª©ì‚­ì œ : removeItem(í‚¤ëª…)
                (6) ê°œìˆ˜ : length

            [ JS ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ : sessionStorage ]
            -> ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì™€ ì°¨ì´ì ì€?
            -> ë¸Œë¼ìš°ì €ê°€ ë‹«íˆë©´ ë°ì´í„°ê°€ ì‚¬ë¼ì§„ë‹¤!
            (ë¡œì»¬ì„¸ì…˜ì˜ ê°œë…ì€ ì„œë²„ì„¸ì…˜ê³¼ ë‹¬ë¦¬ í•˜ë‚˜ì˜ ë¸Œë¼ìš°ì €íƒ­ì„
            ë‹¨ìœ„ë¡œ í•œë‹¤!)
            -> ì„œë²„ì„¸ì…˜ì€ ì ‘ì†ëœ ë¡œê·¸ì¸ì •ë³´ì„¸ì…˜ì„ ì„œë²„ì—ì„œ ê´€ë¦¬í•˜ëŠ” ë‹¨ìœ„ì„

            [ JS ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ / ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ ì¥ë‹¨ì  ]
            (1) ì¥ì : ê°„ë‹¨í•œ í”„ë¡ íŠ¸ì—”ë“œ ë°ì´í„°ë¥¼ DBì—†ì´ í…ŒìŠ¤íŠ¸í•´ë³´ëŠ”ë° íƒì›”í•¨
            (2) ë‹¨ì : ë°ì´í„°ì˜ ì§€ì† ë³´ì¥ì´ ì—†ë‹¤!
                (ê·¸ë‚˜ë§ˆ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ëŠ” ë¸Œë¼ìš°ì € ê²½ë¡œê°€ ê°™ê³  PCê°€ ê°™ê³ 
                ë¸Œë¼ìš°ì €ì¢…ë¥˜ê°€ ê°™ë‹¤ë©´ ì§€ìš°ê¸° ì „ê¹Œì§€ëŠ” ë°ì´í„°ë¥¼ ìœ ì§€í•œë‹¤!)


            -> w3 schools ì°¸ê³ 
            https://www.w3schools.com/js/js_api_web_storage.asp
        */

            // ì „ì—­ë³€ìˆ˜
            let com_name;
            let com_role;
            let com_cat;

            ///// ë¡œë“œêµ¬ì—­ ////////////////////
            window.addEventListener("DOMContentLoaded", () => {
                // ì²˜ìŒì— ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ë°ì´í„°ê°€ ì¡´ì¬ì—¬ë¶€ë¥¼
                // ì²´í¬í•˜ì—¬ í‘œì‹œìš”ì†Œì— ë³´ì—¬ì£¼ê¸°!
                if (localStorage.getItem("minfo") != "") {
                    bindData();
                }
            }); ///////////// ë¡œë“œêµ¬ì—­ ///////////

            // ì´ˆê¸°ì…‹íŒ… í•¨ìˆ˜
            function startFn(pm) {
                if (pm === "ë¡œì¹¼ì“°") {
                    localStorage.setItem("lname", "ì´ì •ì¬");
                    localStorage.setItem("lrole", "ë°•í‰í˜¸ì—­");
                    localStorage.setItem("lcat", "ì¡°ì§ë‚´ ìŠ¤íŒŒì´ë¥¼ ìƒ‰ì¶œí•˜ëŠ” í•´ì™¸íŒ€ ì•ˆê¸°ë¶€íŒ€ì¥");
                    // í™•ì¸
                    console.log("ë¡œì¹¼:", localStorage.length);
                } else if (pm === "ì„¸ì…˜ì“°") {
                    sessionStorage.setItem("sname", "ì •ìš°ì„±");
                    sessionStorage.setItem("srole", "ê¹€ì •ë„ì—­");
                    sessionStorage.setItem("scat", "êµ­ë‚´íŒ€ ì•ˆê¸°ë¶€íŒ€ì¥,ë°•í‰í˜¸ë‘ ì‚¬ì´ë‚˜ì¨");
                    // í™•ì¸
                    console.log("ì„¸ì…˜:", sessionStorage.length);
                }
            } ///////////// startFn //////////////
            // ì „ì²´ì§€ìš°ê¸° í•¨ìˆ˜
            function delFn(pm) {
                if (pm === "ë¡œì¹¼ì“°") {
                    localStorage.clear();
                    // í™•ì¸
                    console.log("ë¡œì¹¼:", localStorage.length);
                } else if (pm === "ì„¸ì…˜ì“°") {
                    sessionStorage.clear();
                    // í™•ì¸
                    console.log("ì„¸ì…˜:", sessionStorage.length);
                }
            } ///////////// startFn //////////////

            // ë³´ì—¬ì¤˜ í•¨ìˆ˜
            function showFn(pm) {
                //pm - ì„ íƒë¶€ëª¨ìš”ì†Œ

                // ë¡œì»¬ìŠ¤í† ë¦¬ì§€/ì„¸ì…˜ìŠ¤í† ë¦¬ì§€ ë¶„ê¸°
                if (pm === ".local") {
                    com_name = localStorage.getItem("lname");
                    com_role = localStorage.getItem("lrole");
                    com_cat = localStorage.getItem("lcat");
                } else if (pm === ".session") {
                    com_name = sessionStorage.getItem("sname");
                    com_role = sessionStorage.getItem("srole");
                    com_cat = sessionStorage.getItem("scat");
                }

                // ì¶œë ¥í•˜ê¸°
                document.querySelector(pm + " .nm").innerText = com_name;
                document.querySelector(pm + " .role").innerText = com_role;
                document.querySelector(pm + " .cat").innerText = com_cat;
            } ////////////// showFn ////////////////////

            //// ê°ì²´ ìƒì„±í•˜ì—¬ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ë„£ê¸° /////
            function makeObj() {
                // ê²Œì‹œíŒ í˜•ì‹ì˜ ê°ì²´ë¥¼ ìƒì„±í•¨!
                let obj = [
                    {
                        idx: 1,
                        tit: "ë‚´ê°€ ì™•ì´ë  ìƒì¸ê°€?",
                        cont: "ì´ì •ì¬í˜•ì€ ì§„ì • ì™•ì´ì‹­ë‹ˆë‹¤!",
                    },
                ];

                // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ë„£ê¸°
                // ë°°ì—´/ê°ì²´ë¥¼ ì§ì ‘ ë„£ìœ¼ë©´ ë°ì´í„°í˜• í‘œì‹œë¬¸ìê°’ë§Œ
                // ì…ë ¥ì´ ë˜ê³  ì‹¤ì œ ê°ì²´ëŠ” ì…ë ¥ë˜ì§€ ì•ŠëŠ”ë‹¤!
                // ì™œ????? ë¡œì»¬ìŠ¤í† ë¦¬ì§€ëŠ” ë¬¸ìí˜•ë§Œ ë°›ìœ¼ë‹ˆê¹Œ!!!
                // ê·¸ë˜ì„œ ë°°ì—´/ê°ì²´ë¥¼ ë¬¸ìë°ì´í„° í™”í•´ì„œ ë„£ëŠ”ë‹¤!
                // JSON.stringify(ë°°ì—´/ê°ì²´)
                localStorage.setItem("minfo", JSON.stringify(obj));
                console.log(localStorage.getItem("minfo"));
            } /////////// makeObj ///////////////////////

            // í™”ë©´ ë°ì´í„° ë°”ì¸ë”© í•¨ìˆ˜ //////////
            function bindData() {
                let hcode = `
                    <table>
                        <tr>
                            <th>ë²ˆí˜¸</th>
                            <th>ì œëª©</th>
                            <th>ë‚´ìš©</th>
                            <th>ì‚­ì œ</th>
                        </tr>
                    `;
                // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ê°ì²´ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                // ì…ë ¥ëœ ë°ì´í„°ëŠ” ë¬¸ìí˜• ê°ì²´ì´ë¯€ë¡œ
                // ë‹¤ì‹œ íŒŒì‹±í•˜ì—¬ ì›ë˜ ê°ì²´ë¡œ ë³µì›í•œë‹¤!
                let org = localStorage.getItem("minfo");
                org = JSON.parse(org);
                console.log("ë³€í™˜ê°ì²´:", org);

                // ë°°ì—´ê°œìˆ˜ê°€ 0ì´ ì•„ë‹ˆë©´ forEachë¬¸ ëŒë©´ì„œ ë°ì´í„° ì§‘ì–´ ë„£ê¸°!
                // : â­ì´ë ‡ê²Œ ë°ì´í„°ê°€ ìˆëŠ” ê²½ìš° ì—†ëŠ” ê²½ìš° ë‚˜ëˆ ì„œ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°ë„ ì²˜ë¦¬í•´ì¤˜ì•¼ ì—ëŸ¬ê°€ ì•ˆìƒê¹€
                if(org.length !== 0){
                    // ië³€ìˆ˜ëŠ” ë°°ì—´ì˜ ìˆœë²ˆ(ìœ ì¼í‚¤!)
                    org.forEach((val, i) => {
                        hcode += `
                            <tr>
                                <td>${val.idx}</td>
                                <td>${val.tit}</td>
                                <td>${val.cont}</td>
                                <td>
                                    <a href="#" 
                                    onclick="delRec(${i})">Ã—</a>
                                </td>
                            </tr>
                        `;
                    });
                } ////////// if ////////////
                // ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
                else{
                    hcode += `
                        <tr>
                            <td colspan="4" style="text-align:center">
                                ì£„ì†¡í•©ë‹ˆë‹¤...ğŸ‘€ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤...ğŸ‘€
                            </td>
                        </tr>
                    `;
                } ////////// else : ë°ì´í„° ì—†ëŠ”ê²½ìš° ///////////

                

                hcode += "</table>";

                // htmlì— ë„£ê¸°
                document.querySelector(".board").innerHTML = hcode;
            } /////////// bindData ////////////////

            // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ë°ì´í„°ì— ì—…ë°ì´íŠ¸ í•˜ëŠ” í•¨ìˆ˜
            function insData() {
                // 1. ì…ë ¥í•­ëª© ì½ì–´ì˜¤ê¸°: #tit ì œëª©, #cont ë‚´ìš©
                let tit = document.querySelector("#tit").value;
                let cont = document.querySelector("#cont").value;

                // 2. ë§Œì•½ í•˜ë‚˜ë¼ë„ ë¹„ì—ˆë‹¤ë©´ ëŒì•„ê°€!
                if (tit.trim() == "" || cont.trim() == "") {
                    alert("ì…ë ¥ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤~!!");
                    return;
                }

                console.log("ì…ë ¥ì²˜ë¦¬!!!");

                // 3. ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° : minfo
                // ê°€ì ¸ì˜¨ í›„ ê°ì²´í˜•ìœ¼ë¡œ ì‚¬ìš©í•˜ë„ë¡ íŒŒì‹±í•œë‹¤!!!
                let org = localStorage.getItem("minfo");
                org = JSON.parse(org);
                console.log("ì…ë ¥ì „ê°ì²´:", org);

                // 4. ì…ë ¥ë°ì´í„°ë¥¼ ê°ì²´í˜•ì‹ìœ¼ë¡œ êµ¬ì„±í•˜ê¸°
                // ë‹¨, idx í•­ëª©ì€ ìë™ì¦ê°€í•  ê²ƒì„! ë§ˆì§€ë§‰ ë°°ì—´idx+1
                // ë°°ì—´ì˜ ë§ˆì§€ë§‰ë²ˆí˜¸ëŠ” [ë°°ì—´ê°œìˆ˜-1]
                let last_idx = org[org.length - 1].idx;
                console.log("ë§ˆì§€ë§‰ë°°ì—´idx:", last_idx);

                // ë°°ì—´ë’¤ì— ë°€ì–´ë„£ê¸° ë©”ì„œë“œ : push(ê°’)
                org.push({
                    idx: Number(last_idx) + 1,
                    tit: tit,
                    cont: cont,
                });

                console.log("ì¶”ê°€í›„ê°ì²´:", org);

                // 5. ê°ì²´ë¥¼ ë¬¸ìí˜•ìœ¼ë¡œ ë³€í™˜í›„ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ë°˜ì˜
                localStorage.setItem("minfo", JSON.stringify(org));
                console.log("ë°˜ì˜í›„ ë¡œì¹¼ì“°:", localStorage.getItem("minfo"));

                // 6. ì…ë ¥í›„ í™”ë©´ì— í‘œì‹œí•˜ê¸° ìœ„í•´ ë°”ì¸ë”©í•¨ìˆ˜í˜¸ì¶œ!
                bindData();
            } /////////// insData /////////////

            // íŠ¹ì •í•­ëª© ë°ì´í„° ì‚­ì œ í•¨ìˆ˜ ///////
            function delRec(i) {
                // iëŠ” ë°°ì—´ë°ì´í„° ìˆœë²ˆ(ìœ ì¼í‚¤!)

                // 0.ê¸°ë³¸ê¸°ëŠ¥ ë§‰ê¸°(aìš”ì†Œ)
                event.preventDefault();

                // 1. ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° : minfo
                // ê°€ì ¸ì˜¨ í›„ ê°ì²´í˜•ìœ¼ë¡œ ì‚¬ìš©í•˜ë„ë¡ íŒŒì‹±í•œë‹¤!!!
                let org = localStorage.getItem("minfo");
                org = JSON.parse(org);
                console.log("ì œê±°ì „ê°ì²´:", org);

                // 2. íŠ¹ì •ë°ì´í„° ë°°ì—´í•­ëª© ì‚­ì œ
                // splice(ìˆœë²ˆ,ê°œìˆ˜) -> ìˆœë²ˆë¶€í„° ëª‡ê°œ ì§€ì›€
                // confirm(ë©”ì‹œì§€) : í™•ì¸,ì·¨ì†Œ ì¤‘ í™•ì¸ì¼ê²½ìš° true ë¦¬í„´í•¨
                // (ì•ŒëŒë©”ì‹œì§€ì²˜ëŸ¼ ëœ¬ë‹¤)
                if(confirm("ì •ë§ì •ë§ì •ë§ë¡œ ì§€ìš°ì‹œê² ìŠµë‹ˆê¹Œ?ğŸ‘€")){
                    org.splice(i,1);
                    console.log("ì œê±°í›„ê°ì²´:", org);
                }

                // 3. ê°ì²´ë¥¼ ë¬¸ìí˜•ìœ¼ë¡œ ë³€í™˜í›„ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ë°˜ì˜
                localStorage.setItem("minfo", JSON.stringify(org));
                console.log("ë°˜ì˜í›„ ë¡œì¹¼ì“°:", localStorage.getItem("minfo"));

                // 4. ì…ë ¥í›„ í™”ë©´ì— í‘œì‹œí•˜ê¸° ìœ„í•´ ë°”ì¸ë”©í•¨ìˆ˜í˜¸ì¶œ!
                bindData();
            } /////////////// delRec ////////////
        </script>
    </head>
    <body>
        <div class="tit"></div>
        <div class="wrap">
            <div class="local">
                <h2>ë¡œì¹¼ì“°ë‹˜</h2>
                <div class="imgbx">
                    <img
                        src="https://img.marieclairekorea.com/2022/08/mck_62e9fd08ca1bd.jpg"
                        alt="ì´ì •ì¬" />
                </div>
                <ol>
                    <li>ë‹¹ì‹ ì˜ ì´ë¦„ì€? : <span class="nm"></span></li>
                    <li>ì˜í™”ì† ì—­í• ì€? : <span class="role"></span></li>
                    <li>ìºë¦­í„°ëŠ”? : <span class="cat"></span></li>
                </ol>

                <button onclick="startFn('ë¡œì¹¼ì“°')">ì²˜ìŒ</button>
                <button onclick="showFn('.local')">ë³´ì—¬ì¤˜</button>
                <button onclick="delFn('ë¡œì¹¼ì“°')">ì „ì²´ì‚­ì œ</button>
                <button onclick="makeObj()">ì²˜ë¦¬</button>
                <button onclick="bindData()">ì—…ë°ì´íŠ¸</button>

                <div class="board"></div>

                <div class="inbx">
                    <!-- <form action="" method="post"> -->
                    <ul>
                        <li>
                            <label for="tit">ì œëª©</label>
                            <input type="text" id="tit" />
                        </li>
                        <li>
                            <label for="cont">ë‚´ìš©</label>
                            <input type="text" id="cont" />
                        </li>
                        <li>
                            <input type="submit" value="ì…ë ¥" id="sbtn" onclick="insData()" />
                        </li>
                    </ul>
                    <!-- </form> -->
                </div>
            </div>
            <div class="session">
                <h2>ì„¸ì…˜ì“°ë‹˜</h2>
                <div class="imgbx ib2">
                    <img
                        src="https://img.marieclairekorea.com/2022/08/mck_62e9fd08ca1bd.jpg"
                        alt="ì •ìš°ì„±" />
                </div>
                <ol>
                    <li>ë‹¹ì‹ ì˜ ì´ë¦„ì€? : <span class="nm"></span></li>
                    <li>ì˜í™”ì† ì—­í• ì€? : <span class="role"></span></li>
                    <li>ìºë¦­í„°ëŠ”? : <span class="cat"></span></li>
                </ol>

                <button onclick="startFn('ì„¸ì…˜ì“°')">ì²˜ìŒ</button>
                <button onclick="showFn('.session')">ë³´ì—¬ì¤˜</button>
                <button onclick="delFn('ì„¸ì…˜ì“°')">ì „ì²´ì‚­ì œ</button>
                <button onclick="">ì²˜ë¦¬</button>
                <button onclick="">ì¶”ê°€</button>
            </div>
        </div>
    </body>
</html>