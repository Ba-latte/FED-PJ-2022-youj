// ì‡¼í•‘ëª° ë°°ë„ˆ JS - 03.í˜ì´ë“œíš¨ê³¼ //

// ë¡œë”©í›„ loadFní•¨ìˆ˜ í˜¸ì¶œ //////////
window.addEventListener("DOMContentLoaded", loadFn);

/******************************************** 
 * 
    [ í˜ì´ë“œ íš¨ê³¼ ìŠ¬ë¼ì´ë“œ ê¸°ëŠ¥ì •ì˜ ]
    -> ìŠ¬ë¼ì´ë“œ ìˆœë²ˆì— ëŒ€í•œ ì „ì—­ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤!

    1. ì˜¤ë¥¸ìª½ ë²„íŠ¼í´ë¦­ì‹œ ë‹¤ìŒ ìˆœë²ˆìŠ¬ë¼ì´ë“œì—
    í´ë˜ìŠ¤ "on"ì„ ì¤˜ì„œ opacity:1, z-index:1
    ë¡œ ë³´ì´ë©° ë§¨ìœ„ë¡œ ì„¤ì •í•´ì¤€ë‹¤!(íŠ¸ëœì§€ì…˜ì ìš©)
    ->ë‚˜ë¨¸ì§€ liëŠ” ëª¨ë‘ "on"ì„ ì§€ì›Œì„œ ì´ˆê¸°í™”!

    2. ì™¼ìª½ë²„íŠ¼ì€ ì´ì „ìˆœë²ˆì´ ë‚˜ì˜¤ë©° ìœ„ì™€ ë™ì¼

    3. ëë²ˆí˜¸ì— ê°€ì„œëŠ” ì²˜ìŒì€ ë§ˆì§€ë§‰ìœ¼ë¡œ 
    ë§ˆì§€ë§‰ì€ ì²˜ìŒìœ¼ë¡œ ìŠ¬ë¼ì´ë“œê°€ ë‹¤ì‹œ ë°˜ë³µëœë‹¤.

    4. ë¸”ë¦¿ì€ í˜„ì¬ ìŠ¬ë¼ì´ë“œì™€ ì¼ì¹˜ëœ ìˆœë²ˆí‘œì‹œ

********************************************/

/****************************************** 
    í•¨ìˆ˜ëª…: loadFn
    ê¸°ëŠ¥: ë¡œë”©í›„ ì´ë²¤íŠ¸ì„¤ì • ë° ìŠ¬ë¼ì´ë“œ ê¸°ëŠ¥
******************************************/

function loadFn() {
    // 0.í˜¸ì¶œ í™•ì¸
    console.log("ë¡œë”© ì™„ë£Œ!");

    // ğŸŒˆìŠ¬ë¼ì´ë“œ ë²ˆí˜¸ ë³€ìˆ˜ ë§Œë“¤ê¸°! : 0~4ê¹Œì§€ ë‹´ìœ¼ë ¤ê³ 
    let snum = 0;

    // 1.ëŒ€ìƒ ì„ ì •
    // 1-1.ì´ë²¤íŠ¸ ëŒ€ìƒ : .abtn
    const abtn = document.querySelectorAll(".abtn");
    // console.log(abtn);

    // 1-2. ë³€ê²½ ëŒ€ìƒ : #slide > li
    const slide = document.querySelectorAll("#slide>li");

    // 1-3. ë¶ˆë¦¿ ëŒ€ìƒ : .indic li
    const indic = document.querySelectorAll(".indic li");

    // ğŸŒˆìŠ¬ë¼ì´ë“œ ê°œìˆ˜ ë³€ìˆ˜ ë§Œë“¤ê¸° : ê°œìˆ˜ ì•Œê³  ì‹¶ìœ¼ë©´ .lengthë¥¼ ì‚¬ìš©í•˜ë©´ ë¨
    let scnt = slide.length;
    console.log("ìŠ¬ê°œìˆ˜: ", scnt);

    // ê´‘í´ê¸ˆì§€ë³€ìˆ˜ : 0 - í—ˆìš©, 1 - ë¶ˆí—ˆìš©
    let prot = 0;

    // 2.ìŠ¬ë¼ì´ë“œ ë³€ê²½ í•¨ìˆ˜ ë§Œë“¤ê¸° - í• ë‹¹í˜• í•¨ìˆ˜ë¡œ ë§Œë“¤ê¸°
    const goSlide = (seq) => {
        // 2-0. í™•ì¸
        console.log("ìŠ¬ë¼ì´ë“œê³ ìš°!", seq);

        // ê´‘í´ê¸ˆì§€ ì„¤ì •í•˜ê¸° //////
        if (prot) return;
        prot = 1; // ì ê¸ˆ!
        setTimeout(() => {
            prot = 0; // í•´ì œ!
        }, 400); /// 0.4ì´ˆí›„ í•´ì œ! ///

        // 2-1. ë°©í–¥ì— ë”°ë¥¸ ë¶„ê¸°
        // 2-1-1. ì˜¤ë¥¸ìª½ ë²„íŠ¼ í´ë¦­ì‹œ : seq===1
        if (seq) {
            // ìŠ¬ë¼ì´ë“œ ë²ˆí˜¸ ì¦ê°€ì‹œí‚¤ê¸°!
            snum++;

            // í™•ì¸
            console.log("ì˜¤ë¥¸!", snum);
        }
        // 2-1-2. ì™¼ìª½ ë²„íŠ¼ í´ë¦­ì‹œ : seq===0
        else {
            // ìŠ¬ë¼ì´ë“œ ë²ˆí˜¸ ê°ì†Œì‹œí‚¤ê¸°!
            snum--;

            // í™•ì¸
            console.log("ì™¼!", snum);
        }

        // 4.í•œê³„ê°’ ì²´í¬í•˜ê¸° (5ë²ˆë¶€í„°ëŠ” ì—†ìœ¼ë‹ˆê¹Œ ë„˜ì–´ê°€ì§€ ì•Šë„ë¡ ì œì–´í•´ì¤˜ì•¼í•¨ / ë§¨ ì™¼ìª½ìœ¼ë¡œ ê°”ì„ ë•Œë„ ë§ˆì°¬ê°€ì§€ì„)
        // : ì²˜ìŒì´ì „ -> ëìœ¼ë¡œ ì´ë™, ëë‹¤ìŒ -> ì²˜ìŒìœ¼ë¡œ ì´ë™í•˜ë„ë¡ ë§Œë“¤ê¸°
        if (snum === -1) snum = scnt - 1;
        else if (snum === scnt) snum = 0;

        // ğŸ’•ì•„ì˜ˆ ì´ë™ ëª»í•˜ê²Œ ë§‰ì•„ë‘ëŠ” ë°©ë²•ë„ ìˆìŒ
        // if(snum===-1) snum = 0;
        // else if(snum === scnt) snum = scnt - 1;

        // 2-2. ì´ë™í•˜ê¸° : í•´ë‹¹ìˆœë²ˆ ìŠ¬ë¼ì´ë“œ liì— í´ë˜ìŠ¤ on ë„£ê¸°
        // ë³€ê²½ ëŒ€ìƒ : slideë³€ìˆ˜ (#slide li)
        chgSlide(slide);

        // 5. ë¶ˆë¦¿ ë³€ê²½í•˜ê¸° : í•´ë‹¹ìˆœë²ˆ ë¶ˆë¦¿ liì— í´ë˜ìŠ¤ on ë„£ê¸°
        // ë³€ê²½ ëŒ€ìƒ : indic ë³€ìˆ˜ (.indic li)
        chgSlide(indic);

    }; //////////////// goSlide í•¨ìˆ˜ ë /////////////////////

    // 3.ëŒ€ìƒì— ì´ë²¤íŠ¸ ì„¤ì •í•˜ê¸°
    // : abtnë²„íŠ¼ í´ë¦­í•˜ë©´
    abtn.forEach((ele, idx) => {
        ele.onclick = () => {
            // ìŠ¬ë¼ì´ë“œí•¨ìˆ˜ í˜¸ì¶œ
            goSlide(idx);
            // ìë™ë„˜ê¹€ ë©ˆì¶¤í•¨ìˆ˜ í˜¸ì¶œ
            clearAuto();
        }; //////////// onclick ë ///////////////
    }); //////////////////////// forEach ë /////////////////////////////

    // ì¸í„°ë°œí•¨ìˆ˜ ì§€ìš°ê¸°ìœ„í•œ ë³€ìˆ˜
    let autoI;
    // íƒ€ì„ì•„ì›ƒí•¨ìˆ˜ ì§€ìš°ê¸°ìœ„í•œ ë³€ìˆ˜
    let autoT;

    /************************************ 
        í•¨ìˆ˜ëª…: autoSlide
        ê¸°ëŠ¥: ì¸í„°ë°œí•¨ìˆ˜ë¡œ ìŠ¬ë¼ì´ë“œí•¨ìˆ˜ í˜¸ì¶œ
    ************************************/
    function autoSlide() {
        console.log("ì¸í„°ë°œì‹œì‘!");
        // ì¸í„°ë°œí•¨ìˆ˜ë¡œ ìŠ¬ë¼ì´ë“œí•¨ìˆ˜ í˜¸ì¶œí•˜ê¸°
        autoI = setInterval(() => goSlide(1), 3000);
    } ////////////// autoSlideí•¨ìˆ˜ //////////

    // ìë™ë„˜ê¹€ ìµœì´ˆí˜¸ì¶œ!
    autoSlide();

    /************************************ 
        í•¨ìˆ˜ëª…: clearAuto
        ê¸°ëŠ¥: ì¸í„°ë°œí•¨ìˆ˜ë¥¼ ì§€ìš°ê³  ë‹¤ì‹œì…‹íŒ…
   ************************************/
    function clearAuto() {
        console.log("ì¸í„°ë°œë©ˆì¶¤!");
        // 1. ì¸í„°ë°œ ì§€ìš°ê¸°
        clearInterval(autoI);

        // 2. íƒ€ì„ì•„ì›ƒë„ ì§€ìš°ì§€ ì•Šìœ¼ë©´
        // ìŒ“ì—¬ì„œ íƒ€ì„ì•„ì›ƒ ì“°ë‚˜ë¯¸ì‹¤í–‰ì´ ë°œìƒí•œë‹¤!
        clearTimeout(autoT);

        // 3. ì ì‹œí›„ ë‹¤ì‹œ ì‘ë™í•˜ë„ë¡ íƒ€ì„ì•„ì›ƒìœ¼ë¡œ
        // ì¸í„°ë°œí•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤!
        // 5ì´ˆí›„(ì¸í„°ë°œì€ 3ì´ˆí›„, í† íƒˆ 8ì´ˆí›„ ì‘ë™ì‹œì‘)
        autoT = setTimeout(autoSlide, 5000);
    } ///////// clearAuto í•¨ìˆ˜ /////////////

    /*************************************
        ê¸°ëŠ¥ : ë¶ˆë¦¿ í´ë¦­ì‹œ ìŠ¬ë¼ì´ë“œ ì´ë™í•˜ê¸°
    *************************************/
    // ì´ë²¤íŠ¸ ëŒ€ìƒ : .indic li -> indic ë³€ìˆ˜
    // ì´ë²¤íŠ¸ ì¢…ë¥˜ : click
    indic.forEach((ele, idx) => {
        ele.onclick = () => {
            // 1.â­â­â­â­ì „ì—­ë³€ìˆ˜ snum ì—…ë°ì´íŠ¸í•˜ê¸°â­â­â­â­
            // ì™œ? ë¶ˆë¦¿ ìˆœë²ˆ === ìŠ¬ë¼ì´ë“œ ìˆœë²ˆ ì´ë¯€ë¡œ!
            snum = idx;

            // 2.ë¶ˆë¦¿ ë³€ê²½í•˜ê¸° : í´ë˜ìŠ¤ on ë„£ê¸°
            chgSlide(indic);

            // 4.ìŠ¬ë¼ì´ë“œ ë³€ê²½í•˜ê¸° : í•´ë‹¹ìˆœë²ˆ ìŠ¬ë¼ì´ë“œ liì— í´ë˜ìŠ¤ on ë„£ê¸°
            // ë³€ê²½ ëŒ€ìƒ : slideë³€ìˆ˜ (#slide li)
            chgSlide(slide);

            // 5.ìë™ë„˜ê¹€ ë©ˆì¶¤í•¨ìˆ˜ í˜¸ì¶œí•˜ê¸°!
            clearAuto();

        }; ////////////// click ////////////////
    }); //////////// forEach ////////////


    /*************************************************
        ìŠ¬ë¼ì´ë“œ / ë¶ˆë¦¿ ë³€ê²½ ê¸°ëŠ¥ ê³µí†µ í•¨ìˆ˜ (í´ë˜ìŠ¤ì— onë„£ê³ ë¹¼ëŠ” ê²ƒ ë§í•¨)
        í•¨ìˆ˜ëª… : chgSlide
    *************************************************/
    function chgSlide(obj){ // obj : ë³€ê²½ëŒ€ìƒ ë…¸ë“œë¦¬ìŠ¤íŠ¸(ì—¬ëŸ¬ê°œê°€ ë‹´ê¸´ ì• ë“¤~)
        // í˜¸ì¶œí™•ì¸
        // console.log("ê³µí†µí•¨ìˆ˜ í˜¸ì¶œ!");

        // ì „ì²´ë¦¬ìŠ¤íŠ¸ ì´ˆê¸°í™”
        obj.forEach((ele) => ele.classList.remove("on"));
        // í•´ë‹¹ ìˆœë²ˆì˜ liì— í´ë˜ìŠ¤ ë„£ê¸°
        obj[snum].classList.add("on");
    } /////////////////////// chgSlide í•¨ìˆ˜ ///////////////////////////




} /////////////// loadFn í•¨ìˆ˜ //////////////
