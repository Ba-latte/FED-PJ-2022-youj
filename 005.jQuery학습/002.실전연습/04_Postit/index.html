<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>drag and drop 기능</title>
        <style>
            div.draggable {
                float: left;
                width: 160px;
                height: 160px;
                padding: 10px 0px 0px 20px;
                background: url(post.png) no-repeat;
                font-size: 14px;
            }
            /* 일반 선택,드래그 막기 */
            .draggable *{
                user-select: none;
                -webkit-user-drag: none;
            }

            div.draggable img {
                width: 130px;
                height: 80px;
            }

            div.invert {
                background: url(post2.png) no-repeat;
            }

            /* 드롭박스 */
            .dropshow {
                width: 500px;
                height: 400px;
                text-align: center;
                background: url(addimg/effect2.jpg) no-repeat center/cover;
                font: bold 36px/400px "맑은 고딕", "굴림";
                color: #f00;
                text-shadow: 1px 0 #fff, -1px 0 #fff, 0 1px #fff, 0 -1px #fff;
                /* 글자그림자를 이용한 테두리 */
                margin: 50px auto;
                /* 가로중앙 */
            }

            /* 드래그 박스 */
            .dbox {
                width: 720px;
                height: 170px;
                margin: 0 auto;
                border: 2px dashed blue;
            }
        </style>

        <script src="jquery-3.6.0.min.js"></script>
        <script src="jquery-ui.min.js"></script>
		<!-- 기본적으로 드래그 기능은 모바일에서는 안됨!
		모바일이벤트로 변환해주는 제이쿼리 플러그인을 추가해준다! 아래! -->
		<script src="jquery-touch-punch.min.js"></script>
        <!-- 
		미리보기:
		https://tombap8.github.io/FED211/004.jQuery학습/jQuery-02.실전연습/04.jQuery_utility/01_Postit/ready.html
        공식 설명서 : https://api.jqueryui.com/draggable/
        -->
        
    </head>
    <script>
        // 제이쿼리 구역 ///////////
        $(()=>{
            
            // 1.드래그 대상
            const dg = $(".draggable");

            // 2.드래그 설정
            // draggable() 메서드 호출만으로 드래그이동이 가능함
            // 옵션은 중괄호{}안에 객체값으로 세팅 가능함
            dg.draggable({
                // 옵션은 객체값으로 쓰면 됨 (속성:값)
                // (1)커서 옵션 바꾸기 : "이동중" 모양으로 바꾸기
                cursor:"move",
                // (2)드래그대상 상위처리(z값 높여주기)
                stack:".draggable",
                // (3)이동중 투명도 조절
                opacity:0.7,

            }); //////////// draggable ///////////////

            // [ 커스터마이징 요구사항 반영하기 ]

            // 💛1.드래그시 포스트잇 이미지 변경하기
            // (1)드래그 시작이벤트 발생시 이미지 변경 위해 클래스 .invert 넣기
            // 드래그 시작 이벤트: dragstart
            // 제이쿼리 메서드 : on("이벤트명", 함수)
            dg.on("dragstart", function(){
                // 대상 : 끌고다니는 나 자신
                $(this).addClass("invert");
                
            }); ///////////// dragstart 이벤트 //////////////

            // (2)드래그 끝날 때 이벤트 발생시 이미지 변경 위해 클래스 .invert 빼기
            // 드래그 종료 이벤트: dragstop
            // 제이쿼리 메서드 : on("이벤트명", 함수)
            dg.on("dragstop", function(){
                // 대상 : 끌고다니는 나 자신
                $(this).removeClass("invert");

            }); ///////////// dragstop 이벤트 //////////////


            // 💛2.드롭 대상박스에 드롭될 때 동영상 보여주기
            // droppable() 메서드 : 드롭되는 요소 처리하는 메서드
            // 이벤트 대상 : .dropshow

            $(".dropshow").droppable({
                drop:function(evt, ele){
                    // evt : 이벤트 전달 변수 / ele : 드롭 관련 객체
                    console.log("나 빠졌다~~");

                    // 1.드롭영역의 배경 이미지 변경하기
                    // 드롭된 요소 : ele.draggable
                    let isrc = ele.draggable.find("img").attr("src");
                    console.log(isrc);

                    $(this).css({
                        // 여기서 this는 드롭박스 나 자신임!
                        background:`url(${isrc})`
                    })
                }
            }); ////////////// droppable 이벤트 /////////////////






        }); ///////////// jQB //////////////////
    </script>

    <body>
        <!-- 드롭 박스 -->
        <div class="dropshow">여기에 드롭하세요~~!</div>

        <!-- 
		w3c에서 허용하는 새로운 속성은 data- 라는 시작명으로
		작성하면 된다!
		-> data-내가지은이름="값"
		예) data-myhouse="값"
        -->

        <!-- 드래그 박스 -->
        <div class="dbox">
            <!-- data-mv속성은 동영상코드 셋업 -->
            <div class="draggable" data-mv="67O-LdK3kFA">
                <p>쇼핑몰 자유이용권</p>
                <img src="addimg/gm.jpg" alt="쥐마켓" />
            </div>
            <div class="draggable" data-mv="JDKhD-QNcvM">
                <p>롯떼월들 자유이용권</p>
                <img src="addimg/lottee.jpg" alt="롯떼월들" />
            </div>
            <div class="draggable" data-mv="miSL86dtqis">
                <p>큐챠 자유이용권</p>
                <img src="addimg/coocha.jpg" alt="큐챠" />
            </div>
            <div class="draggable" data-mv="ISTsLeAGQ9Q">
                <p>해외여행 자유이용권</p>
                <img src="addimg/effect1.jpg" alt="허나투어" />
            </div>
        </div>
    </body>
</html>
